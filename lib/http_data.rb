# frozen_string_literal: true

class HttpData
  # HTTP Status codes with Japanese descriptions
  STATUS_CODES = {
    # 1xx Informational
    100 => '処理を継続中。クライアントはリクエストを続行できる',
    101 => 'プロトコル切り替え。サーバーがプロトコル変更に同意',
    103 => '早期ヒント。リンク先リソースの先読みを許可',

    # 2xx Success
    200 => 'リクエスト成功。最も一般的な成功レスポンス',
    201 => 'リソース作成成功。新しいリソースが作成された',
    202 => 'リクエスト受理。処理はまだ完了していない',
    204 => 'コンテンツなし。成功したが返すコンテンツがない',
    206 => '部分的コンテンツ。範囲リクエストに対する応答',

    # 3xx Redirection
    301 => '恒久的に移動。リソースが永久に新しいURLへ移動',
    302 => '一時的に移動（発見）。一時的に別のURLにある',
    303 => '他を参照。別のURIでリソースを取得すべき',
    304 => '未更新。キャッシュされたバージョンが有効',
    307 => '一時的リダイレクト。同じメソッドで別URLへ',
    308 => '恒久的リダイレクト。同じメソッドで永久に別URLへ',

    # 4xx Client Error
    400 => '不正なリクエスト。構文エラーなどでサーバーが理解できない',
    401 => '認証が必要。有効な認証情報が含まれていない',
    403 => 'アクセス禁止。認証済みでもアクセス権限がない',
    404 => 'リソースが見つからない。要求されたリソースが存在しない',
    405 => '許可されていないメソッド。そのメソッドは使用不可',
    406 => '受理不可。受け入れ可能なコンテンツがない',
    408 => 'リクエストタイムアウト。接続がアイドル状態で時間切れ',
    409 => '競合。リソースの現在の状態と矛盾する',
    410 => '消滅。リソースが永久に削除された',
    413 => 'ペイロードが大きすぎる。リクエストボディが大きすぎる',
    414 => 'URIが長すぎる。リクエストURIが長すぎる',
    415 => 'サポートされていないメディアタイプ',
    418 => '私はティーポット。コーヒーを淹れることを拒否',
    422 => '処理できないエンティティ。意味的に正しくない',
    429 => 'リクエストが多すぎる。レート制限に達した',
    451 => '法的理由により利用不可。法的要求で利用制限',

    # 5xx Server Error
    500 => 'サーバー内部エラー。予期しないエラーが発生',
    501 => '未実装。サーバーがその機能をサポートしていない',
    502 => '不正なゲートウェイ。上流サーバーから無効な応答',
    503 => 'サービス利用不可。サーバーが一時的に過負荷',
    504 => 'ゲートウェイタイムアウト。上流サーバーからの応答なし',
    505 => 'HTTPバージョン非対応。そのHTTPバージョンをサポートしない'
  }.freeze

  # MDN Web Docsを参考にした詳細な解説
  DETAILED_EXPLANATIONS = {
    # 1xx Informational
    100 => '暫定レスポンスで、その時点までにすべてに問題がなく、クライアントはリクエストを継続してよいことを示します。',
    101 => 'クライアントからのUpgradeリクエストヘッダーのレスポンスとして送信され、サーバーがプロトコルを切り替えていることを示します。',
    103 => '主にLinkヘッダーと共に使用され、サーバーがレスポンスを準備している間、ユーザーエージェントにリソースの事前読み込みを開始させます。',

    # 2xx Success
    200 => 'リクエストが成功したことを示します。成功の意味はHTTPメソッドにより異なります（GET: リソース取得、POST: 処理結果など）。',
    201 => 'リクエストが成功し、その結果新たなリソースが作成されたことを示します。通常、POSTやPUTリクエスト後のレスポンスです。',
    202 => 'リクエストは受理されたが、まだ実行されていないことを示します。別のプロセスやバッチ処理で処理される予定です。',
    204 => 'リクエストに対して送信するコンテンツはありませんが、ヘッダーは有用であることを示します。キャッシュの更新などに使われます。',
    206 => 'クライアントが範囲リクエストで、リソースの一部だけをリクエストしたときに使用されます。動画のストリーミングなどで活用されます。',

    # 3xx Redirection
    301 => 'リクエストされたリソースのURLが永遠に変更されたことを示します。レスポンスで新しいURLが与えられ、ブックマークの更新が推奨されます。',
    302 => 'リクエストされたリソースのURIが一時的に変更されたことを示します。将来さらに変更される可能性があるため、同じURIを使い続けるべきです。',
    303 => 'サーバーが、リクエストされたリソースを別のURIでGETリクエストを使用して取得するようクライアントを誘導します。',
    304 => 'キャッシュ用に使用されます。クライアントにレスポンスが変更されておらず、キャッシュされたバージョンを使い続けられることを伝えます。',
    307 => 'リソースを別のURIで、元のリクエストと同じメソッドを使用して取得するよう誘導します。302と異なり、HTTPメソッドを変更してはいけません。',
    308 => 'リソースがLocationヘッダーで指定した別のURIへ永続的に置かれていることを示します。301と異なり、HTTPメソッドを変更してはいけません。',

    # 4xx Client Error
    400 => 'クライアントのエラー（不正なリクエスト構文、不正なフレーム、不正なルーティング）のため、サーバーがリクエストを処理できません。',
    401 => 'クライアントは認証を受ける必要があります。HTTP標準では"unauthorized"と定義されていますが、意味的には"unauthenticated"です。',
    403 => '認証されていないなどの理由でクライアントにコンテンツのアクセス権がなく、サーバーが適切なレスポンスの返信を拒否しています。',
    404 => 'サーバーがリクエストされたリソースを発見できません。ウェブで最も有名なステータスコードの一つです。',
    405 => 'サーバーがリクエストメソッドを理解しているものの、対象のリソースでは利用できません。例えば、読み取り専用リソースへのPOSTなど。',
    406 => 'サーバーがリクエストのAcceptヘッダーで指定された条件を満たすコンテンツを生成できないことを示します。',
    408 => 'サーバーがリクエストを待っている間に接続がアイドル状態になり、タイムアウトしたことを示します。',
    409 => 'リクエストがリソースの現在の状態と矛盾していることを示します。同時編集の競合などで発生します。',
    410 => 'リクエストされたリソースがサーバー上で永久に削除され、転送先もないことを示します。404との違いは「永久に」という点です。',
    413 => 'リクエストエンティティが、サーバーが処理できる上限を超えていることを示します。ファイルアップロードの制限などで使用されます。',
    414 => 'クライアントがリクエストしたURIが、サーバーが処理できる長さを超えていることを示します。',
    415 => 'リクエストされたメディアタイプをサーバーがサポートしていないため、リクエストを拒否しました。',
    418 => 'ジョークのステータスコードです。1998年のエイプリルフールRFCで定義された「私はティーポットです」というユーモアです。',
    422 => 'リクエストは正しい形式ですが、意味的なエラーにより処理できません。バリデーションエラーなどで使用されます。',
    429 => 'ユーザーが一定の時間内に大量のリクエストを送信しました。レート制限（Rate Limiting）に達したことを示します。',
    451 => 'ユーザーエージェントが違法なリソースをリクエストしています。検閲されたウェブページなど、法的理由で利用できません。',

    # 5xx Server Error
    500 => 'サーバー側で処理方法がわからない事態が発生したことを示す、汎用的なサーバーエラーです。',
    501 => 'リクエストメソッドをサーバーが対応しておらず、扱えません。サーバーは GET と HEAD のサポートは必須です。',
    502 => 'ゲートウェイまたはプロキシとして動作するサーバーが、上流サーバーから無効なレスポンスを受け取りました。',
    503 => 'サーバーはリクエストを処理する準備ができていません。メンテナンスや過負荷が一般的な原因で、通常は一時的な状態です。',
    504 => 'ゲートウェイまたはプロキシとして動作するサーバーが、上流サーバーから時間内にレスポンスを得られませんでした。',
    505 => 'リクエストで使用されたHTTPバージョンをサーバーがサポートしていないことを示します。'
  }.freeze

  class << self
    def all_codes
      STATUS_CODES.keys
    end

    def description(code)
      STATUS_CODES[code]
    end

    def random_code
      all_codes.sample
    end

    def random_codes_except(excluded_code, count:)
      available = all_codes - [excluded_code]
      available.sample(count)
    end

    def code_with_description(code)
      { code: code, description: STATUS_CODES[code] }
    end

    def detailed_explanation(code)
      DETAILED_EXPLANATIONS[code] || STATUS_CODES[code]
    end
  end
end
